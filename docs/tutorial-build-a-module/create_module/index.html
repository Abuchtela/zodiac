<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<title data-react-helmet="true">Build Your Module | Zodiac</title><meta data-react-helmet="true" property="og:url" content="https://zodiac.eth/zodiac/docs/tutorial-build-a-module/create_module"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Build Your Module | Zodiac"><meta data-react-helmet="true" name="description" content="What is a module?"><meta data-react-helmet="true" property="og:description" content="What is a module?"><link data-react-helmet="true" rel="shortcut icon" href="/zodiac/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://zodiac.eth/zodiac/docs/tutorial-build-a-module/create_module"><link data-react-helmet="true" rel="alternate" href="https://zodiac.eth/zodiac/docs/tutorial-build-a-module/create_module" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zodiac.eth/zodiac/docs/tutorial-build-a-module/create_module" hreflang="x-default"><link rel="stylesheet" href="/zodiac/assets/css/styles.7af6cf84.css">
<link rel="preload" href="/zodiac/assets/js/runtime~main.57b5d52e.js" as="script">
<link rel="preload" href="/zodiac/assets/js/main.53e2be84.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zodiac/"><img src="/zodiac/img/logo.png" alt="Zodiac" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zodiac/img/logo.png" alt="Zodiac" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Zodiac</b></a><a class="navbar__item navbar__link navbar__link--active" href="/zodiac/docs/intro">Get Started</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/gnosis/zodiac" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåô</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">‚òÄÔ∏è</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/zodiac/docs/intro">Zodiac Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorial: Bridge Module</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorial: Roles Modifier</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorial: Exit Module</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Tutorial: Build your own module</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zodiac/docs/tutorial-build-a-module/setup">Setup</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/zodiac/docs/tutorial-build-a-module/create_module">Build Your Module</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zodiac/docs/tutorial-build-a-module/deploy_module">Deploy Your Module</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zodiac/docs/tutorial-build-a-module/deploy_on_rinkeby">Deploy To Rinkeby</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorial: Exit App</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorial: Reality Module</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorial: Delay Modifier</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Build Your Module</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="what-is-a-module"></a>What is a module?<a class="hash-link" href="#what-is-a-module" title="Direct link to heading">#</a></h2><p>By default, Gnosis Safes operate as multisig wallets, requiring confirmation from <em>n</em> of <em>m</em> signers in order to execute transactions. However, in addition to (or instead of) using the multisig logic, you can enable &quot;modules&quot; on your Gnosis Safe. Modules are simply addresses that are allowed to bypass the normal multisig logic by calling some special functions, <code>execTransactionFromModule()</code> or <code>execTransactionFromModuleReturnData()</code>.</p><p>Earlier, you deployed and set up a Mock Safe and a Button that can only be pushed by the Mock Safe.</p><p>Now we&#x27;ll create a Module that can trigger the Mock Safe to push the Button.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="import-modulesol"></a>Import Module.sol<a class="hash-link" href="#import-modulesol" title="Direct link to heading">#</a></h2><p>First and foremost, Zodiac is a philosophy for building composable DAO tooling. To make easier on aspiring module developers, we&#x27;ve built a library of tools that you can import into your own contracts to help ensure your modules are Zodiac compatible and to reduce the amount of time and effort for you to implement your module.</p><p>Simply import <a href="https://github.com/gnosis/zodiac/blob/master/contracts/core/Module.sol" target="_blank" rel="noopener noreferrer">Module.sol</a> from the Zodiac library and add whatever logic your module needs.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pragma solidity ^0.8.6;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import &quot;@gnosis.pm/zodiac/contracts/core/Module.sol&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">contract MyModule is Module {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  /// insert your code here</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In our case, we want to add a function to tell our Safe to push the button.</p><p>Define and <code>address button</code> variable and add a <code>pushButton</code> function to your contract which calls the <code>exec()</code> function from <code>Module.sol</code>.</p><p><code>exec()</code> will call the <code>execTransactionFromModule()</code> function on the connected Safe.
It has four parameters:</p><ul><li><strong>to:</strong> the address that the safe will call. The Button contract in our case.</li><li><strong>value:</strong> the amount of ETH in wei that should be sent with the transaction. This is zero in our case.</li><li><strong>data:</strong> the ABI encoded transaction data that the data for the safe&#x27;s transaction. In our case this is the function selector for the <code>pushButton()</code> function.</li><li><strong>operation:</strong> defines whether the transaction should be a call or a delegate call. In our case, we&#x27;ll just do a call.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">address public button;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">function pushButton() external {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    exec(</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        button,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        0,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        abi.encodePacked(bytes4(keccak256(&quot;pushButton()&quot;))),</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Enum.Operation.Call</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    );</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>That&#x27;s essentially it!
The bulk of your work in creating a module is defining the conditions under which <code>exec()</code> can be called.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="factory-friendly"></a>Factory Friendly<a class="hash-link" href="#factory-friendly" title="Direct link to heading">#</a></h2><p>Wait... I&#x27;m still seeing compiler errors.</p><p><code>Module.sol</code> provides another convenience feature to enable any module to be compatible with our <a href="https://github.com/gnosis/zodiac/blob/master/contracts/factory/ModuleProxyFactory.sol" target="_blank" rel="noopener noreferrer">ModuleProxyFactory</a> and the Zodiac Safe App. This makes it easier to streamline deployment and setup of modules so, for example, we can do things like batch deployment of a safe, its modules, and the calls to enable the modules into one Ethereum transaction. ü§Ø</p><p>Before our contract will compile, you&#x27;ll need to add a constructor and a setup function. The constructor is a function that is automatically called only once when the contract is deployed and is usually used to initialize the contract. Notice that our constructor simply ABI encodes the parameters that were passed in and then calls the <code>setUp()</code> function. This gives users the option to deploy the module directly, or to deploy it using the <a href="https://github.com/gnosis/zodiac/blob/master/contracts/factory/ModuleProxyFactory.sol" target="_blank" rel="noopener noreferrer">ModuleProxyFactory</a>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly solidity"><pre tabindex="0" class="prism-code language-solidity codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">constructor(address _owner, address _button) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    bytes memory initializeParams = abi.encode(_owner, _button);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    setUp(initializeParams);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// @dev Initialize function, will be triggered when a new proxy is deployed</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/// @param initializeParams Parameters of initialization encoded</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">function setUp(bytes memory initializeParams) public override initializer {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    __Ownable_init();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    (address _owner, address _button) = abi.decode(initializeParams, (address, address));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    button = _button;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    setAvatar(_owner);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    setTarget(_owner);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    transferOwnership(_owner);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Our <code>setUp()</code> function will set the <code>button</code> address, then <code>avatar</code>, <code>target</code>, and <code>owner</code> will all be set to the same address.
In most cases, these three addresses will be set to the same, but there are subtle distinctions between the three and sometimes they may need to be different.</p><ul><li><strong>Avatar:</strong> is the Safe. The Address that will ultimately execute the transaction that is passed by the module.</li><li><strong>Target:</strong> is the address that this module will call <code>execTransactionFromModule()</code> on. In most cases this will be the Safe, but in some cases it could be a special kind of module called a <a href="https://github.com/gnosis/zodiac/blob/master/contracts/core/Modifier.sol" target="_blank" rel="noopener noreferrer">modifier</a>, that sits between a module and an avatar and... well... modifies the transactions passed to it in some way.</li><li><strong>Owner:</strong> is the address that has permissions to call <code>OnlyOwner()</code> functions on the module.</li></ul><p>In case your <code>MyModule.sol</code> is still not compiled, <a href="https://gist.github.com/auryn-macmillan/841906d0bc6c2624e83598cdfac17de8" target="_blank" rel="noopener noreferrer">here&#x27;s one we baked earlier</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/gnosis/zodiac/edit/master/website/docs/tutorial-build-a-module/02_create_module.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zodiac/docs/tutorial-build-a-module/setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Setup</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zodiac/docs/tutorial-build-a-module/deploy_module"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploy Your Module ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-module" class="table-of-contents__link">What is a module?</a></li><li><a href="#import-modulesol" class="table-of-contents__link">Import Module.sol</a></li><li><a href="#factory-friendly" class="table-of-contents__link">Factory Friendly</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zodiac/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/wwmBWTgyEq" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/gnosisguild" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://gnosisguild.mirror.xyz/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/gnosis/zodiac" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 Gnosis.</div></div></div></footer></div>
<script src="/zodiac/assets/js/runtime~main.57b5d52e.js"></script>
<script src="/zodiac/assets/js/main.53e2be84.js"></script>
</body>
</html>